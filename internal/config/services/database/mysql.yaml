name: mysql
description: MySQL relational database for persistent data storage
category: database
dependencies:
  required: []
  soft: []
  conflicts:
  - postgres
  provides:
  - database
  - sql
docker:
  restart: unless-stopped
  networks:
  - otto-stack
  memory_limit: 512m
  environment:
  - MYSQL_HOST=localhost
  - MYSQL_PORT=${MYSQL_PORT:-3306}
  - MYSQL_DATABASE=${MYSQL_DATABASE:-local_dev}
  - MYSQL_USER=${MYSQL_USER:-root}
  - MYSQL_PASSWORD=${MYSQL_PASSWORD:-password}
  - MYSQL_ROOT_PASSWORD=${MYSQL_PASSWORD:-password}
  - MYSQL_URL=mysql://${MYSQL_USER:-root}:${MYSQL_PASSWORD:-password}@localhost:${MYSQL_PORT:-3306}/${MYSQL_DATABASE:-local_dev}
  - DATABASE_URL=mysql://${MYSQL_USER:-root}:${MYSQL_PASSWORD:-password}@localhost:${MYSQL_PORT:-3306}/${MYSQL_DATABASE:-local_dev}
  health_check:
    test:
    - CMD
    - mysqladmin
    - ping
    - -h
    - localhost
    - -u
    - root
    - -p${MYSQL_PASSWORD:-password}
    interval: 10s
    timeout: 5s
    retries: 5
    start_period: 30s
  image: mysql:8.0
management:
  operations: null
  connect:
    command:
    - mysql
    args:
      user:
      - -u
      - '{{.User}}'
      database:
      - '{{.Database}}'
      password:
      - -p
    defaults:
      user: root
  backup:
    type: command
    command:
    - mysqldump
    - -u
    - '{{.User}}'
    - -p
    args:
      database:
      - '{{.Database}}'
      all:
      - --all-databases
    defaults:
      user: root
    extension: sql
  restore:
    type: command
    pre_commands:
      clean:
      - - mysql
        - -u
        - '{{.User}}'
        - -p
        - -e
        - DROP DATABASE IF EXISTS {{.Database}};
      - - mysql
        - -u
        - '{{.User}}'
        - -p
        - -e
        - CREATE DATABASE {{.Database}};
    command:
    - mysql
    - -u
    - '{{.User}}'
    - -p
    args:
      database:
      - '{{.Database}}'
    defaults:
      user: root
documentation:
  examples:
  - mysql -h localhost -u root -p -e "SELECT version();"
  - spring.datasource.url=jdbc:mysql://localhost:3306/my_app_dev
  usage_notes: MySQL database for relational data storage. Alternative to PostgreSQL.
  links:
  - https://dev.mysql.com/doc/
  use_cases:
  - Primary application database
  - Transactional data storage
  - Relational data modeling
  docs:
  - name: MySQL Documentation
    url: https://dev.mysql.com/doc/
service_configuration:
- name: docker_image
  type: string
  description: Docker image to use for MySQL container
  default: mysql:8-oracle
  example: mysql:8.0
  required: false
- name: port
  type: integer
  description: Port number for MySQL server
  default: '3306'
  example: '3307'
  required: false
- name: database
  type: string
  description: Default database name to create
  default: local_dev
  example: myapp_dev
  required: false
- name: username
  type: string
  description: MySQL username
  default: root
  example: myuser
  required: false
- name: password
  type: string
  description: MySQL password
  default: password
  example: mySecurePassword123
  required: false
- name: memory_limit
  type: string
  description: Memory limit for MySQL container
  default: 512m
  example: 1g
  required: false
