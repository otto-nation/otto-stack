name: mysql
description: MySQL relational database for persistent data storage
service_type: container

environment:
  DATABASE_URL: mysql://${MYSQL_USER:-root}:${MYSQL_PASSWORD:-password}@${MYSQL_HOST:-localhost}:${MYSQL_PORT:-3306}/${MYSQL_DATABASE:-local_dev}
  MYSQL_DATABASE: ${MYSQL_DATABASE:-local_dev}
  MYSQL_HOST: ${MYSQL_HOST:-localhost}
  MYSQL_PASSWORD: ${MYSQL_PASSWORD:-password}
  MYSQL_PORT: ${MYSQL_PORT:-3306}
  MYSQL_URL: mysql://${MYSQL_USER:-root}:${MYSQL_PASSWORD:-password}@${MYSQL_HOST:-localhost}:${MYSQL_PORT:-3306}/${MYSQL_DATABASE:-local_dev}
  MYSQL_USER: ${MYSQL_USER:-root}

container:
  image: mysql:8.0
  ports:
    - external: "3306"
      internal: "3306"
      protocol: tcp
  environment:
    MYSQL_ROOT_PASSWORD: ${MYSQL_PASSWORD:-password}
    MYSQL_DATABASE: ${MYSQL_DATABASE:-local_dev}
  restart: unless-stopped
  memory_limit: 512m
  health_check:
    test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
    interval: 30s
    timeout: 10s
    retries: 3

service:
  connection:
    type: cli
    default_port: 3306
    default_user: root
    client: mysql
    host_flag: -h
    port_flag: -P
    user_flag: -u
  dependencies:
    conflicts:
      - postgres
    provides:
      - database
      - sql
  management:
    connect:
      type: command
      command: ["mysql"]
      args:
        default: ["-h", "localhost", "-P", "3306", "-u", "root", "-p"]

configuration_schema:
  type: object
  properties:
    database:
      type: string
      default: "local_dev"
      description: Default database name
    password:
      type: string
      default: "password"
      description: Root password
    user:
      type: string
      default: "root"
      description: Database user

documentation:
  examples:
    - mysql -h localhost -u root -p -e "SELECT version();"
    - spring.datasource.url=jdbc:mysql://localhost:3306/my_app_dev
  usage_notes: MySQL database for relational data storage. Alternative to PostgreSQL.
  links:
    - https://dev.mysql.com/doc/
  use_cases:
    - Primary application database
    - Transactional data storage
    - Relational data modeling
